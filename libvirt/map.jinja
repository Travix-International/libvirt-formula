{% set map = salt['grains.filter_by']({
    'Debian': {
        'pkgs': [
            'libguestfs0',
            'libguestfs-tools',
            'libvirt0',
            'qemu-kvm',
            'libvirt-bin',
            'python-libvirt',
            'gnutls-bin',
        ],
        'service': 'libvirtd' if grains.get('osmajorrelease', 0)|float >= 8 else 'libvirt-bin',
        'guests_service': 'libvirt-guests',
        'guests_service_enable': True,
    },
    'RedHat': {
        'pkgs': [
            'libguestfs',
            'libvirt',
            'qemu-kvm',
            'libvirt-python',
        ],
        'service': 'libvirtd',
        'guests_service': 'libvirt-guests',
        'guests_service_enable': True,
    },
    'Arch': {
        'pkgs': [
            'libguestfs',
            'libvirt',
            'qemu',
            'libvirt-python',
        ],
        'service': 'libvirtd',
        'guests_service': 'libvirt-guests',
        'guests_service_enable': True,
    },
}, merge=salt['pillar.get']('libvirt:lookup')) %}
